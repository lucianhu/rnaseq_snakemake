Building DAG of jobs...
shared_storage_local_copies: True
remote_exec: False
Using shell: /usr/bin/bash
Provided cores: 24
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job            count
-----------  -------
all                1
trim_galore        2
total              3

Resources before job selection: {'_cores': 24, '_nodes': 9223372036854775807}
Ready jobs (2)
Select jobs to execute...
Selected jobs (2)
Resources after job selection: {'_cores': 8, '_nodes': 9223372036854775805}
Execute 2 jobs...

[Tue Aug 13 16:31:32 2024]
localrule trim_galore:
    input: /home/lucianhu/rna_snakemake/rna_snakemake/test-datasets/testdata/SRR6357070_1.fastq.gz, /home/lucianhu/rna_snakemake/rna_snakemake/test-datasets/testdata/SRR6357070_2.fastq.gz
    output: results/trimmed/WT_1_val_1.fq.gz, results/trimmed/WT_2_val_2.fq.gz, results/trimmed/WT.trimming_report.txt
    log: logs/trim_galore/WT.log
    jobid: 1
    reason: Missing output files: results/trimmed/WT_1_val_1.fq.gz, results/trimmed/WT_2_val_2.fq.gz
    wildcards: sample=WT
    threads: 8
    resources: tmpdir=/tmp

unlocking
removing lock
removing lock
removed all locks
Full Traceback (most recent call last):
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/utils.py", line 427, in format
    return fmt.format(_pattern, *args, **variables)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/string.py", line 190, in format
    return self.vformat(format_string, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/string.py", line 194, in vformat
    result, _ = self._vformat(format_string, args, kwargs, used_args, 2)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/string.py", line 234, in _vformat
    obj, arg_used = self.get_field(field_name, args, kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/string.py", line 299, in get_field
    obj = self.get_value(first, args, kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/string.py", line 256, in get_value
    return kwargs[key]
           ~~~~~~^^^^^
KeyError: 'len(input'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/jobs.py", line 948, in format_wildcards
    return format(string, **_variables)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/utils.py", line 437, in format
    raise NameError(
NameError: The name 'len(input' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/cli.py", line 2103, in args_to_api
    dag_api.execute_workflow(
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/api.py", line 594, in execute_workflow
    workflow.execute(
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/workflow.py", line 1248, in execute
    raise e
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/workflow.py", line 1244, in execute
    success = self.scheduler.schedule()
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/scheduler.py", line 313, in schedule
    self.run(
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/scheduler.py", line 406, in run
    executor.run_jobs(jobs)
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake_interface_executor_plugins/executors/base.py", line 71, in run_jobs
    self.run_job_pre(job)
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake_interface_executor_plugins/executors/base.py", line 86, in run_job_pre
    self.printjob(job)
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake_interface_executor_plugins/executors/base.py", line 110, in printjob
    job.log_info()
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/jobs.py", line 1042, in log_info
    logger.shellcmd(self.shellcmd, indent=indent)
                    ^^^^^^^^^^^^^
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/jobs.py", line 601, in shellcmd
    self.format_wildcards(self.rule.shellcmd)
  File "/home/lucianhu/micromamba/envs/rna_snakemake/lib/python3.12/site-packages/snakemake/jobs.py", line 950, in format_wildcards
    raise RuleException(
snakemake.exceptions.RuleException: NameError: The name 'len(input' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}, when formatting the following:

        # Create symbolic links
        [ ! -f {wildcards.sample}_1.fastq.gz ] && ln -s {input.reads[0]} {wildcards.sample}_1.fastq.gz
        if [ {len(input.reads)} -eq 2 ]; then
            [ ! -f {wildcards.sample}_2.fastq.gz ] && ln -s {input.reads[1]} {wildcards.sample}_2.fastq.gz
            trim_galore {params.extra}                 --cores {params.cores}                 --paired                 --gzip                 {wildcards.sample}_1.fastq.gz                 {wildcards.sample}_2.fastq.gz                 2> {log}
        else
            trim_galore {params.extra}                 --cores {params.cores}                 --gzip                 {wildcards.sample}_1.fastq.gz                 2> {log}
        fi

        # Generate versions.yml
        echo '"'"{rule}"'"':' > {output.report}
        echo '    trimgalore: '$(trim_galore --version 2>&1 | sed 's/^.*version //; s/Last.*$//') >> {output.report}
        echo '    cutadapt: '$(cutadapt --version) >> {output.report}
        

RuleException in rule trim_galore in file /home/lucianhu/rna_snakemake/test_ting/Snakefile, line 37:
NameError: The name 'len(input' is unknown in this context. Please make sure that you defined that variable. Also note that braces not used for variable access have to be escaped by repeating them, i.e. {{print $1}}, when formatting the following:

        # Create symbolic links
        [ ! -f {wildcards.sample}_1.fastq.gz ] && ln -s {input.reads[0]} {wildcards.sample}_1.fastq.gz
        if [ {len(input.reads)} -eq 2 ]; then
            [ ! -f {wildcards.sample}_2.fastq.gz ] && ln -s {input.reads[1]} {wildcards.sample}_2.fastq.gz
            trim_galore {params.extra}                 --cores {params.cores}                 --paired                 --gzip                 {wildcards.sample}_1.fastq.gz                 {wildcards.sample}_2.fastq.gz                 2> {log}
        else
            trim_galore {params.extra}                 --cores {params.cores}                 --gzip                 {wildcards.sample}_1.fastq.gz                 2> {log}
        fi

        # Generate versions.yml
        echo '"'"{rule}"'"':' > {output.report}
        echo '    trimgalore: '$(trim_galore --version 2>&1 | sed 's/^.*version //; s/Last.*$//') >> {output.report}
        echo '    cutadapt: '$(cutadapt --version) >> {output.report}
        
